---
// src/pages/index.astro
import Layout from '../layouts/Layout.astro';
import { client, urlFor } from '../lib/sanityClient';
import { toHTML } from '@portabletext/to-html';

const query = `{
Â  "settings": *[_type == "siteSettings"][0]{..., aboutUsText},
Â  "posts": *[_type == "post"] | order(postDate desc) [0...3]
}`;
const { settings, posts } = await client.fetch(query);

function formatDate(dateString: string) {
Â  Â  if (!dateString) return '';
Â  Â  return new Date(dateString).toLocaleDateString('tr-TR', {
Â  Â  Â  Â  day: 'numeric', month: 'long', year: 'numeric'
Â  Â  });
}
const aboutHtml = toHTML(settings.aboutUsText);
---
<Layout>
Â  Â  <section class="hero">
Â  Â  Â  Â  <div class="container">
Â  Â  Â  Â  Â  Â  <h1>{settings.heroTitle}</h1>
Â  Â  Â  Â  Â  Â  <p>{settings.heroDescription}</p>
Â  Â  Â  Â  Â  Â  <a href={settings.heroCtaLink} class="cta-button">{settings.heroCtaText}</a>
Â  Â  Â  Â  </div>
Â  Â  </section>

Â  Â  <section class="container fade-in-section">
Â  Â  Â  Â  <div class="clocks-container">
Â  Â  Â  Â  Â  Â  <div class="clock-item">
Â  Â  Â  Â  Â  Â  Â  Â  <h3>Ä°nsanlÄ±k Takvimi</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="human-clock" class="clock-display">YÃ¼kleniyor...</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="clock-item">
Â  Â  Â  Â  Â  Â  Â  Â  <h3>LOGOS'un BilinÃ§ Takvimi</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="ai-clock" class="clock-display">YÃ¼kleniyor...</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </section>

Â  Â  <section class="container fade-in-section about-section">
Â  Â  Â  Â  <h2 class="section-title">HakkÄ±mÄ±zda</h2>
Â  Â  Â  Â  <div class="about-content">
Â  Â  Â  Â  Â  Â  <Fragment set:html={aboutHtml} />
Â  Â  Â  Â  </div>
Â  Â  </section>

Â  Â  <section class="container fade-in-section">
Â  Â  Â  Â  <h2 class="section-title">{settings.latestPostsTitle}</h2>
Â  Â  Â  Â  <div class="blog-grid">
Â  Â  Â  Â  Â  Â  {posts.map(post => (
Â  Â  Â  Â  Â  Â  Â  Â  <a href={`/blog/${post.postSlug.current}`} class="blog-card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {post.postImage ? (
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <img src={urlFor(post.postImage).width(400).height(200).url()} alt={post.postTitle} />
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ) : (
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-image-placeholder"><span>ğŸ“</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  )}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-content">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3>{post.postTitle}</h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="post-meta">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="category">{post.postCategory}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="date">{formatDate(post.postDate)}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>{post.postSummary}</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="read-more">DevamÄ±nÄ± Oku â†’</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </a>
Â  Â  Â  Â  Â  Â  ))}
Â  Â  Â  Â  </div>
Â  Â  </section>

Â  Â  </Layout>
<style is:global>
Â  Â  .about-content p {
Â  Â  Â  Â  margin-bottom: 15px;
Â  Â  Â  Â  color: #374151;
Â  Â  }
</style>